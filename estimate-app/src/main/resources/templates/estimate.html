<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Estimate</title>
</head>
<body>
<h1>Create Estimate</h1>

<div th:each="section : ${sections}">
    <h3 th:text="${section.name}"></h3>
    <ul>
        <li th:each="work : ${section.works}">
            <form th:action="@{/estimate/add}" method="post">
                <input type="hidden" name="workId" th:value="${work.id}"/>
                <span th:text="${work.name}"></span>
                <input type="number" name="quantity" placeholder="Quantity" required/>
                <input type="number" step="0.01" name="coefficient" placeholder="Coefficient" value="1.0"/>
                <button type="submit">Add to Estimate</button>
            </form>
        </li>
    </ul>
</div>

<hr/>

<h2>Current Estimate</h2>
<table>
    <thead>
    <tr>
        <th>Work Name</th>
        <th>Unit</th>
        <th>Quantity</th>
        <th>Customer Price</th>
        <th>Coefficient</th>
        <th>Total</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="item : ${session.estimateItems}">
        <td th:text="${item.work.name}"></td>
        <td th:text="${item.work.unit}"></td>
        <td th:text="${item.quantity}"></td>
        <td th:text="${item.work.customerPrice}"></td>
        <td th:text="${item.coefficient}"></td>
        <td th:text="${item.quantity * item.work.customerPrice * item.coefficient}"></td>
    </tr>
    </tbody>
</table>

<a href="/estimate/export">Export to Excel</a>
<br/>
<a href="/works">Back to Works</a>

</body>
</html>
